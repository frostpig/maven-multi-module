/*
 * Copyright (C) 2018 jumei, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may
 * not use this file except in compliance with the License. You may obtain
 * a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations
 * under the License.
 */

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.google.common.base.Splitter;
import com.google.gson.Gson;
import org.apache.commons.lang.StringUtils;

import java.util.List;

/**
 * Function: Please Descrip This Class.
 * <p>
 * Created by shuangshuangl on 2019/7/15.
 * Copyright (c) 2018,shuangshuangl@jumei.com All Rights Reserved.
 */
public class Main {
    public static void main(String[] args) {
        String data00 = "{\"host\":\"172.23.1.207\",\"logmark\":\"bapi\",\"message\":\"OWL\\u0001DATA\\u00010002\\u0001bapi\\u00012019-07-15 11:20:18.000\\u0001172.23.1.207\\u0001Exception\\u0001\\u0001\\u0001WARN\\u0001\\nRPC Exception: RpcClient_ContractSearch::getContractByCond URI：tcp://10.40.72.157:8008 return array (\\n  'class' => 'Exception',\\n  'message' => '搜索调用异常(code:\\\"0\\\")',\\n  'code' => 0,\\n  'file' => '/home/www/crm-service/Search/SearchOperator.php',\\n  'line' => 511,\\n  'traceAsString' => '#0 /home/www/crm-service/Search/SearchOperator.php(573): Search\\\\\\\\SearchOperator->exception(\\\\'\\\\\\\\xE6\\\\\\\\x90\\\\\\\\x9C\\\\\\\\xE7\\\\\\\\xB4\\\\\\\\xA2\\\\\\\\xE8\\\\\\\\xB0\\\\\\\\x83\\\\\\\\xE7\\\\\\\\x94\\\\\\\\xA8\\\\\\\\xE5\\\\\\\\xBC\\\\\\\\x82...\\\\')\\n#1 /home/www/crm-service/Search/SearchBase.php(250): Search\\\\\\\\SearchOperator->requestSearch()\\n#2 /home/www/crm-service/Handler/ContractSearch.php(90): Search\\\\\\\\SearchBase->search()\\n#3 [internal function]: Handler\\\\\\\\ContractSearch->getContractByCond(Array, 1, 50, \\\\'\\\\', \\\\'\\\\')\\n#4 /home/www/PHPServer/workers/JmTextWorker.php(130): call_user_func_array(Array, Array)\\n#5 /home/www/PHPServer/workers/RpcWorker.php(150): JmTextWorker->process(Array)\\n#6 /home/www/PHPServer/core/PHPServerWorker.php(451): RpcWorker->dealProcess(\\\\'3\\\\\\\\nRPC\\\\\\\\n611\\\\\\\\n{\\\"dat...\\\\')\\n#7 [internal function]: PHPServerWorker->dealInputBase(Resource id #49001717, 622, \\\\'3\\\\\\\\nRPC\\\\\\\\n611\\\\\\\\n{\\\"dat...\\\\', 49001717)\\n#8 /home/www/PHPServer/core/events/Select.php(229): call_user_func_array(Array, Array)\\n#9 /home/www/PHPServer/core/PHPServerWorker.php(209): Select->loop()\\n#10 /home/www/PHPServer/workers/RpcWorker.php(58): PHPServerWorker->serve(true)\\n#11 /home/www/PHPServer/core/PHPServer.php(498): RpcWorker->serve()\\n#12 /home/www/PHPServer/core/PHPServer.php(366): PHPServer::forkOneWorker(\\\\'crm-service\\\\')\\n#13 /home/www/PHPServer/core/PHPServer.php(739): PHPServer::createWorkers()\\n#14 /home/www/PHPServer/core/PHPServer.php(556): PHPServer::monitorWorkers()\\n#15 [internal function]: PHPServer::dealCmdResult(Resource id #48997102, 0, \\\\'\\\\', 15165)\\n#16 /home/www/PHPServer/core/events/Select.php(229): call_user_func_array(Array, Array)\\n#17 /home/www/PHPServer/core/PHPServer.php(217): Select->loop()\\n#18 /home/www/PHPServer/core/PHPServer.php(202): PHPServer::loop()\\n#19 /home/www/PHPServer/bin/serverd(57): PHPServer::run(\\\\'\\\\')\\n#20 {main}',\\n) in /var/www/html/vendor/PHPClient/JMTextRpcClient.php on line 1434:\\n#0 [internal function]: PHPClient\\\\ServiceClassWrapper->__call('getContractByCo...', Array)\\n#1 /var/www/html/vendor/linhaihe/laravel-php-client/src/Rpc.php(72): call_user_func_array(Array, Array)\\n#2 /var/www/html/app/Services/CrmService/ContractSearch.php(38): LaravelPhpClient\\\\Rpc->__call('getContractByCo...', Array)\\n#3 /var/www/html/app/Repositories/Contract/ContractSearchRepository.php(45): App\\\\Services\\\\CrmService\\\\ContractSearch->getContractByCond(Array)\\n#4 /var/www/html/app/Repositories/Contract/ContractRepository.php(753): App\\\\Repositories\\\\Contract\\\\ContractSearchRepository->searchUserContractByStoreId('88ed18e4-c680-4...')\\n#5 /var/www/html/app/Http/JdHero/Controllers/ContractController.php(213): App\\\\Repositories\\\\Contract\\\\ContractRepository->getStoreContractDetail('88ed18e4-c680-4...')\\n#6 [internal function]: App\\\\Http\\\\JdHero\\\\Controllers\\\\ContractController->getStoreContractDetail(Object(Illuminate\\\\Http\\\\Request))\\n#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): call_user_func_array(Array, Array)\\n#8 /var/www/html/app/Http/JdHero/Controllers/ContractController.php(56): Illuminate\\\\Routing\\\\Controller->callAction('getStoreContrac...', Array)\\n#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(45): App\\\\Http\\\\JdHero\\\\Controllers\\\\ContractController->callAction('getStoreContrac...', Array)\\n#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\\\\Routing\\\\ControllerDispatcher->dispatch(Object(Illuminate\\\\Routing\\\\Route), Object(App\\\\Http\\\\JdHero\\\\Controllers\\\\ContractController), 'getStoreContrac...')\\n#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(169): Illuminate\\\\Routing\\\\Route->runController()\\n#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(658): Illuminate\\\\Routing\\\\Route->run()\\n#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Routing\\\\Router->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#14 /var/www/html/app/Middleware/VerifyUserLogin.php(26): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): App\\\\Middleware\\\\VerifyUserLogin->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(660): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(635): Illuminate\\\\Routing\\\\Router->runRouteWithinStack(Object(Illuminate\\\\Routing\\\\Route), Object(Illuminate\\\\Http\\\\Request))\\n#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(601): Illuminate\\\\Routing\\\\Router->runRoute(Object(Illuminate\\\\Http\\\\Request), Object(Illuminate\\\\Routing\\\\Route))\\n#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(590): Illuminate\\\\Routing\\\\Router->dispatchToRoute(Object(Illuminate\\\\Http\\\\Request))\\n#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\\\\Routing\\\\Router->dispatch(Object(Illuminate\\\\Http\\\\Request))\\n#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Foundation\\\\Http\\\\Kernel->Illuminate\\\\Foundation\\\\Http\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#24 /var/www/html/vendor/fideloper/proxy/src/TrustProxies.php(57): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Fideloper\\\\Proxy\\\\TrustProxies->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\ValidatePostSize->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/CheckForMaintenanceMode.php(46): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\CheckForMaintenanceMode->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(151): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(116): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request))\\n#42 /var/www/html/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request))\\n#43 {main}\\n\\u0004\",\"offset\":56627,\"path\":\"/home/logs/app/bapi/exception/bapi.20190715.log\",\"project\":bapi\",\"topicid\":\"owl-jiedian\",\"type\":\"owl\",\"@version\":\"1\",\"@timestamp\":\"2019-07-15T03:20:20.869Z\"}";

        String data01 = "{\"host\":\"172.23.2.55\",\"logmark\":\"bapi\",\"message\":\"OWL\\u0001DATA\\u00010002\\u0001bapi\\u00012019-07-15 10:59:17.000\\u0001172.23.2.55\\u0001Exception\\u0001\\u0001\\u0001WARN\\u0001\\n测试异常 in /var/www/html/app/Http/Common/Test/Controllers/RedisController.php on line 41:\\n#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): App\\\\Http\\\\Common\\\\Test\\\\Controllers\\\\RedisController->index(Object(Illuminate\\\\Http\\\\Request))\\n#1 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\\\\Routing\\\\ControllerDispatcher->dispatch(Object(Illuminate\\\\Routing\\\\Route), Object(App\\\\Http\\\\Common\\\\Test\\\\Controllers\\\\RedisController), 'index')\\n#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(169): Illuminate\\\\Routing\\\\Route->runController()\\n#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(658): Illuminate\\\\Routing\\\\Route->run()\\n#4 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Routing\\\\Router->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(660): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(635): Illuminate\\\\Routing\\\\Router->runRouteWithinStack(Object(Illuminate\\\\Routing\\\\Route), Object(Illuminate\\\\Http\\\\Request))\\n#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(601): Illuminate\\\\Routing\\\\Router->runRoute(Object(Illuminate\\\\Http\\\\Request), Object(Illuminate\\\\Routing\\\\Route))\\n#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(590): Illuminate\\\\Routing\\\\Router->dispatchToRoute(Object(Illuminate\\\\Http\\\\Request))\\n#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\\\\Routing\\\\Router->dispatch(Object(Illuminate\\\\Http\\\\Request))\\n#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Foundation\\\\Http\\\\Kernel->Illuminate\\\\Foundation\\\\Http\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#12 /var/www/html/vendor/fideloper/proxy/src/TrustProxies.php(57): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Fideloper\\\\Proxy\\\\TrustProxies->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\ValidatePostSize->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/CheckForMaintenanceMode.php(46): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\CheckForMaintenanceMode->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(151): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(116): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request))\\n#30 /var/www/html/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request))\\n#31 {main}\\n\\u0004\",\"offset\":15080,\"path\":\"/home/logs/app/bapi/exception/bapi.20190715.log\",\"project\":\"bapi\",\"topicid\":\"owl-jiedian\",\"type\":\"owl\",\"@version\":\"1\",\"@timestamp\":\"2019-07-15T02:59:20.695Z\"}";
        String data02="{\"host\":\"172.23.2.55\",\"logmark\":\"bapi\",\"message\":\"OWL\\u0001DATA\\u00010002\\u0001bapi\\u00012019-07-15 16:30:28.000\\u0001172.23.2.55\\u0001Exception\\u0001\\u0001\\u0001WARN\\u0001\\n测试异常 in /var/www/html/app/Http/Common/Test/Controllers/RedisController.php on line 41:\\n#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): App\\\\Http\\\\Common\\\\Test\\\\Controllers\\\\RedisController->index(Object(Illuminate\\\\Http\\\\Request))\\n#1 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\\\\Routing\\\\ControllerDispatcher->dispatch(Object(Illuminate\\\\Routing\\\\Route), Object(App\\\\Http\\\\Common\\\\Test\\\\Controllers\\\\RedisController), 'index')\\n#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Route.php(169): Illuminate\\\\Routing\\\\Route->runController()\\n#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(658): Illuminate\\\\Routing\\\\Route->run()\\n#4 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Routing\\\\Router->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(660): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(635): Illuminate\\\\Routing\\\\Router->runRouteWithinStack(Object(Illuminate\\\\Routing\\\\Route), Object(Illuminate\\\\Http\\\\Request))\\n#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(601): Illuminate\\\\Routing\\\\Router->runRoute(Object(Illuminate\\\\Http\\\\Request), Object(Illuminate\\\\Routing\\\\Route))\\n#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(590): Illuminate\\\\Routing\\\\Router->dispatchToRoute(Object(Illuminate\\\\Http\\\\Request))\\n#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\\\\Routing\\\\Router->dispatch(Object(Illuminate\\\\Http\\\\Request))\\n#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\\\Foundation\\\\Http\\\\Kernel->Illuminate\\\\Foundation\\\\Http\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#12 /var/www/html/vendor/fideloper/proxy/src/TrustProxies.php(57): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Fideloper\\\\Proxy\\\\TrustProxies->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\TransformsRequest->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\ValidatePostSize->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/CheckForMaintenanceMode.php(46): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\\\Foundation\\\\Http\\\\Middleware\\\\CheckForMaintenanceMode->handle(Object(Illuminate\\\\Http\\\\Request), Object(Closure))\\n#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\\\Routing\\\\Pipeline->Illuminate\\\\Routing\\\\{closure}(Object(Illuminate\\\\Http\\\\Request))\\n#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(151): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure))\\n#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(116): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request))\\n#30 /var/www/html/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request))\\n#31 {main}\\n\\u0004\",\"offset\":55127,\"path\":\"/home/logs/app/bapi/exception/bapi.20190715.log\",\"project\":bapi\",\"topicid\":\"owl-jiedian\",\"type\":\"owl\",\"@version\":\"1\",\"@timestamp\":\"2019-07-15T08:30:32.806Z\"}";
        JSONObject object = JSON.parseObject(data01);
        Gson jsonParser = new Gson();
        KafkaMessage km = jsonParser
                .fromJson(data02, KafkaMessage.class);
        System.out.println(km.getMessage());
        String message = km.getMessage();
        List<String> parts = Splitter.on('\u0001').splitToList(message);
        String exception = parts.get(10);
        if (exception != null) {
            int split = exception.indexOf('\n');
            if (split != -1) {
                if (split == 0) {
                    split = exception.indexOf('\n', 1);
                }
                exception = exception.substring(0, split);
            }
        }
        if (StringUtils.isEmpty(message))
            return;
        if (message.length() < 2) {
            System.out.println("get kafka message data length < 2, ignore : {}");
            return;
        }
        if (message.charAt(message.length() - 2) == '\u0004'
                && message.charAt(message.length() - 1) == '\n') {
            message = message.substring(0, message.length() - 2);
        } else if (message.charAt(message.length() - 1) == '\n') {
            message = message.substring(0, message.length() - 1);
        } else if (message.charAt(message.length() - 1) == '\u0004') {
            message = message.substring(0, message.length() - 1);
        }



    }

    private static  boolean validateLogType(String  kafkam) {
        if (kafkam == null)
            return false;
        if ("".endsWith(kafkam))
            return false;
        return kafkam.startsWith("OWL");
    }
}